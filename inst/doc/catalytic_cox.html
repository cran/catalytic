<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yitong Wu ywu039@e.ntu.edu.sg" />


<title>catalytic_cox</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">catalytic_cox</h1>
<h4 class="author">Yitong Wu <a href="mailto:ywu039@e.ntu.edu.sg" class="email">ywu039@e.ntu.edu.sg</a></h4>


<div id="TOC">
<ul>
<li><a href="#Introduction" id="toc-Introduction">Introduction</a></li>
<li><a href="#DataPreparation" id="toc-DataPreparation">Data
Preparation</a></li>
<li><a href="#usage-of-catalytic" id="toc-usage-of-catalytic">Usage of
<code>catalytic</code></a>
<ul>
<li><a href="#Initialization" id="toc-Initialization">Step 1:
Initialization</a></li>
<li><a href="#cat_cox" id="toc-cat_cox">Step 2.1: Choose Method(s) -
Estimation with Fixed tau</a></li>
<li><a href="#cat_cox_tune" id="toc-cat_cox_tune">Step 2.2: Choose
Method(s) - Estimation with Selective tau</a>
<ul>
<li><a href="#CrossValidation" id="toc-CrossValidation">Cross-validation
(risk_estimate_method = “cross_validation”)</a></li>
</ul></li>
<li><a href="#cat_cox_bayes" id="toc-cat_cox_bayes">Step 2.3: Bayesian
Posterior Sampling with Fixed tau</a></li>
<li><a href="#cat_cox_bayes_joint" id="toc-cat_cox_bayes_joint">2.4
Bayesian Posterior Sampling with Adaptive Tau</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="Introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette provides an <em>overview</em> of how to use the
functions in the <strong>catalytic</strong> package that focuses on COX
Regression. The other <strong>catalytic</strong> vignettes go into other
model-estimating functions.</p>
<p>The goal of the <strong>catalytic</strong> package is to build
framework for catalytic prior distributions. Stabilizing
high-dimensional working models by shrinking them towards simplified
models. This is achieved by supplementing observed data with weighted
synthetic data generated from a predictive distribution under the
simpler model. For more information, see <span class="citation">(<a href="#ref-catalytic_cox">Li and Huang 2023</a>)</span>.</p>
<p>The two steps of using catalytic package for COX Regression are</p>
<ol style="list-style-type: decimal">
<li><p>Initialization: The <code>cat_cox_initialization</code> function
constructs a <code>cat_init</code> object based on the formula provided
by the user to generate synthetic data. The resulting
<code>cat_init</code> object is tailored to facilitate further analysis,
and is integral for subsequent modeling steps in the
<code>catalytic</code> package.</p></li>
<li><p>Choose Method(s): Users have the flexibility to choose from four
main functions within the catalytic package: <code>cat_cox</code>,
<code>cat_cox_tune</code>, <code>cat_cox_bayes</code>, and
<code>cat_cox_bayes_joint</code>. Each function serves a specific
purpose in modeling with catalytic priors and offers distinct
capabilities tailored to different modeling scenarios for COX
Regression. This approach enables users to seamlessly incorporate
synthetic data with varying weights from different method into COX
Regression analyses, providing flexibility and control over the modeling
process.</p></li>
</ol>
</div>
<div id="DataPreparation" class="section level1">
<h1>Data Preparation</h1>
<p>Creating a high-dimensional dataset with a low data size. This step
involves increasing the number of features (dimensions) while keeping
the number of observations (data size) relatively small. This is useful
for testing the performance of <code>catalytic</code> models in
high-dimensional settings.</p>
<p>The <code>pbc</code> dataset is loaded and split into training
(<code>train_data</code>) and test (<code>cox_cox_cat_test</code>)
datasets.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(catalytic)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># Compute the Partial Likelihood for the Cox Proportional Hazards Model</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>get_cox_partial_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(X,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                                       time,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                                       status,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                                       coefs,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                                       entry_points) {</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="co"># Identify the risk set indices for Cox proportional hazards model</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  get_cox_risk_set_idx <span class="ot">&lt;-</span> <span class="cf">function</span>(time_of_interest,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>                                   entry_vector,</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>                                   time_vector,</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>                                   status_vector) {</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    time_vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(time_vector)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    entry_vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(entry_vector)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    status_vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(status_vector)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>    <span class="co"># Find indices where subjects are at risk at the given time of interest</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">which</span>((time_of_interest <span class="sc">&gt;=</span> entry_vector) <span class="sc">&amp;</span> (</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>      (time_vector <span class="sc">==</span> time_of_interest <span class="sc">&amp;</span> status_vector <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|</span> (</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>        time_vector <span class="sc">+</span> <span class="fl">1e-08</span> <span class="sc">&gt;</span> time_of_interest))))</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  }</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X)</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  time <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(time)</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>  status <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(status)</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  pl <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>  <span class="co"># Calculate partial likelihood for each censored observation</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">which</span>(status <span class="sc">==</span> <span class="dv">1</span>)) {</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>    risk_set_idx <span class="ot">&lt;-</span> <span class="fu">get_cox_risk_set_idx</span>(</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>      <span class="at">time_of_interest =</span> time[i],</span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>      <span class="at">entry_vector =</span> entry_points,</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>      <span class="at">time_vector =</span> time,</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>      <span class="at">status_vector =</span> status</span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>    )</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>    <span class="co"># Compute the linear predictors for the risk set</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a>    exp_risk_lp <span class="ot">&lt;-</span> <span class="fu">exp</span>(X[risk_set_idx, , <span class="at">drop =</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> coefs)</span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a>    <span class="co"># Update partial likelihood</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a>    pl <span class="ot">&lt;-</span> pl <span class="sc">+</span> <span class="fu">sum</span>(X[i, , <span class="at">drop =</span> <span class="cn">FALSE</span>] <span class="sc">*</span> coefs) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">sum</span>(exp_risk_lp))</span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a>  }</span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a>  <span class="fu">return</span>(pl)</span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a>}</span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co"># Load pbc dataset for Cox proportional hazards model</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pbc&quot;</span>)</span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a>pbc <span class="ot">&lt;-</span> pbc[stats<span class="sc">::</span><span class="fu">complete.cases</span>(pbc), <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>] <span class="co"># Remove NA values and `id` column</span></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a>pbc<span class="sc">$</span>trt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pbc<span class="sc">$</span>trt <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Convert trt to binary</span></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a>pbc<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pbc<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Convert sex to binary</span></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>pbc<span class="sc">$</span>edema2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pbc<span class="sc">$</span>edema <span class="sc">==</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Convert edema2 to binary</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>pbc<span class="sc">$</span>edema <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pbc<span class="sc">$</span>edema <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Convert edema to binary</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>pbc<span class="sc">$</span>time <span class="ot">&lt;-</span> pbc<span class="sc">$</span>time <span class="sc">/</span> <span class="dv">365</span> <span class="co"># Convert time to years</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a>pbc<span class="sc">$</span>status <span class="ot">&lt;-</span> (pbc<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">1</span> <span class="co"># Convert status to binary</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a><span class="co"># Identify columns to be standardized</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a>not_standarlized_index <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">20</span>)</span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a><span class="co"># Standardize the columns</span></span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a>pbc[, <span class="sc">-</span>not_standarlized_index] <span class="ot">&lt;-</span> <span class="fu">scale</span>(pbc[, <span class="sc">-</span>not_standarlized_index])</span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a><span class="co"># Seperate observation data into train and test data</span></span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a>train_n <span class="ot">&lt;-</span> (<span class="fu">ncol</span>(pbc) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pbc), train_n)</span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> pbc[train_idx, ]</span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> pbc[<span class="sc">-</span>train_idx, ]</span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a>test_x <span class="ot">&lt;-</span> test_data[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(test_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;status&quot;</span>))]</span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a>test_time <span class="ot">&lt;-</span> test_data<span class="sc">$</span>time</span>
<span id="cb1-78"><a href="#cb1-78" tabindex="-1"></a>test_status <span class="ot">&lt;-</span> test_data<span class="sc">$</span>status</span>
<span id="cb1-79"><a href="#cb1-79" tabindex="-1"></a>test_entry_points <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(test_x))</span>
<span id="cb1-80"><a href="#cb1-80" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" tabindex="-1"></a><span class="fu">dim</span>(train_data)</span></code></pre></div>
<p>In this section, we explore the foundation steps of fitting a COX
regression model (GLM) using the <code>survival::coxph</code> function
with the gaussian family.</p>
<p>We then proceed to evaluate model performance using the
<code>catalytic::get_discrepancy</code> function, specifically
calculating the logarithmic error discrepancy. This involves comparing
the actual response (<code>Y</code>) against the estimated response
(<code>est_Y</code>) derived from the COX regression model fitted on the
<code>train_data</code>.</p>
<p>Finally, we display the computed logarithmic error to assess the
model’s performance in predicting the response variable
<code>mpg</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Calculate MPLE (Marginal Partial Likelihood Estimate) prediction score with 0 coefficients</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>MPLE_0 <span class="ot">&lt;-</span> <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">X =</span> test_x,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">time =</span> test_time,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">status =</span> test_status,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">coefs =</span> <span class="fu">rep</span>(<span class="dv">0</span>, (<span class="fu">ncol</span>(test_x))),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">entry_points =</span> test_entry_points</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># Fit a COX regression model</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>cox_model <span class="ot">&lt;-</span> survival<span class="sc">::</span><span class="fu">coxph</span>(</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> .,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="at">data =</span> train_data</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Calculate MPLE (Marginal Partial Likelihood Estimate) prediction score of estimated coefficients minus 0 coefficients</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  <span class="st">&quot;MLE COX Model - Predition Score:&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="at">X =</span> test_x,</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    <span class="at">time =</span> test_time,</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    <span class="at">status =</span> test_status,</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="at">coefs =</span> <span class="fu">coef</span>(cox_model),</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>    <span class="at">entry_points =</span> test_entry_points</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  ) <span class="sc">-</span> MPLE_0</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="usage-of-catalytic" class="section level1">
<h1>Usage of <code>catalytic</code></h1>
<div id="Initialization" class="section level2">
<h2>Step 1: Initialization</h2>
<p>To initialize data for a Cox Proportional-Hazards Model using the
<code>catalytic</code> package, the <code>cat_cox_initialization</code>
function is employed. This function facilitates the setup by preparing
synthetic data tailored for modeling purposes.</p>
<p>Here’s a breakdown of the parameters used:</p>
<ul>
<li><p><code>formula</code>: Specifies the model formula, indicating the
time and status variables used for the Cox model. See
<code>?survival::coxph</code> for details on formula syntax.</p></li>
<li><p><code>data</code>: Represents the original dataset, structured as
a <code>data.frame</code>.</p></li>
<li><p><code>syn_size</code>: Determines the size of the synthetic data
generated, defaulted to four times the number of columns in the original
data.</p></li>
<li><p><code>hazard_constant</code>: A constant used in the hazard rate
calculation. Default is the sum of observed statuses divided by the mean
observed time divided by the number of observations.</p></li>
<li><p><code>entry_points</code>: An optional vector specifying the
entry points for the data. Default is a vector of zeros.</p></li>
<li><p><code>x_degree</code>: Determines the degree of the polynomial
terms for the predictors in the model, which affects the diversity or
complexity of the predictor terms included in the model. Defaulted to
<code>NULL</code>, which means the degree for all predictors is
1.</p></li>
<li><p><code>resample_only</code>: Determines whether synthetic data is
exclusively generated by resampling from the original dataset. By
default, it is set to <code>FALSE</code>, allowing the function to apply
various resampling strategies based on the characteristics of
dataset.</p></li>
<li><p><code>na_replace</code>: Specifies the method for handling
missing values in the dataset, defaulted to
<code>stats::na.omit</code>.</p></li>
<li><p><code>...</code> (ellipsis): Allows users to specify additional
arguments that are passed directly to the simple model. This model is
used within the function to generate synthetic responses by fitting
observation data using <code>survival::coxph</code>. By leveraging
<code>...</code>, users can customize the behavior of
<code>survival::coxph</code> within <code>cat_cox_initialization</code>
with additional options.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>cat_init <span class="ot">&lt;-</span> <span class="fu">cat_cox_initialization</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">syn_size =</span> <span class="dv">100</span>, <span class="co"># Default: 4 times the number of predictors</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">hazard_constant =</span> <span class="dv">1</span>, <span class="co"># Default: calculated from observed data</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">entry_points =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(train_data)), <span class="co"># Default: Null, which is vector of zeros</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">x_degree =</span> <span class="cn">NULL</span>, <span class="co"># Default: NULL, which means degrees of all predictors are 1</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">resample_only =</span> <span class="cn">FALSE</span>, <span class="co"># Default: FALSE</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">na_replace =</span> mean <span class="co"># Default: stats::na.omit</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>cat_init</span></code></pre></div>
<p>Here shows how users can simplify the input for
<code>cat_cox_initialization</code>. User do not have to specify
<code>syn_size</code> and other parameters, as they have default values,
which mentioned above.</p>
<p><code>cat_init</code> object contains a list of attributes, which is
typically generated from the above function <span id="Initialization"><code>cat_cox_initialization</code></span>. These
attributes provide comprehensive information for subsequent modeling
tasks or for user checks.</p>
<p>Here’s a breakdown of all attributes except the input parameters:</p>
<ul>
<li><p><code>function_name</code>: The name of this function, which is
<code>cat_cox_initialization.</code></p></li>
<li><p><code>obs_size</code>: The number of observations (rows) in the
original dataset (<code>obs_data</code>).</p></li>
<li><p><code>obs_data</code>: The original dataset
(<code>data</code>).</p></li>
<li><p><code>obs_x</code>: The covariates from the original dataset
(<code>obs_data</code>).</p></li>
<li><p><code>obs_time</code>: The time variable from the original
dataset (<code>obs_data</code>).</p></li>
<li><p><code>obs_status</code>: The status variable from the original
dataset (<code>obs_data</code>).</p></li>
<li><p><code>syn_size</code>: The size of synthetic data
generated.</p></li>
<li><p><code>syn_data</code>: The synthetic data created for modeling
purposes, based on the original dataset (<code>obs_data</code>)
characteristics.</p></li>
<li><p><code>syn_x</code>: The covariates from the synthetic dataset
(<code>syn_data</code>).</p></li>
<li><p><code>syn_time</code>: The time variable from the synthetic
dataset (<code>syn_data</code>).</p></li>
<li><p><code>syn_status</code>: The status variable from the synthetic
dataset (<code>syn_data</code>).</p></li>
<li><p><code>syn_x_resample_inform</code>: The information detailing the
process of resampling synthetic data.</p></li>
<li><p><code>size</code>: The total size of the combined dataset
(<code>obs_size</code> and <code>syn_size</code>).</p></li>
<li><p><code>data</code>: The combined dataset (<code>obs_data</code>
and <code>syn_data</code>).</p></li>
<li><p><code>x</code>: The combined covariates (<code>obs_x</code> and
<code>syn_x</code>).</p></li>
<li><p><code>time</code>: The combined time variable
(<code>obs_time</code> and <code>syn_time</code>).</p></li>
<li><p><code>status</code>: The combined status variable
(<code>obs_status</code> and <code>syn_status</code>).</p></li>
</ul>
<p>For more details, please check
<code>?cat_cox_initialization</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">names</span>(cat_init)</span></code></pre></div>
<p>And of course, user can extract items mentioned above from
<code>cat_cox_initialization</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># The number of observations (rows) in the original dataset (`obs_data`)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>cat_init<span class="sc">$</span>obs_size</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># The information detailing the process of resampling synthetic data</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>cat_init<span class="sc">$</span>syn_x_resample_inform</span></code></pre></div>
</div>
<div id="cat_cox" class="section level2">
<h2>Step 2.1: Choose Method(s) - Estimation with Fixed tau</h2>
<p>The <code>cat_cox</code> function fits a Generalized COX Model (GLM)
with a catalytic prior on the regression coefficients. It utilizes
information from the <code>cat_init</code> object generated during the
initialization step, which includes both observed and synthetic data,
plus other relevant information.</p>
<p>The model is then fitted using the specified formula, family, and a
single <code>tau</code>(synthetic data down-weight factor). The
resulting <code>cat_cox</code> object encapsulates the fitted model,
including estimated coefficients and family information, facilitating
further analysis.</p>
<p>Here’s a breakdown of the parameters used:</p>
<p>To fit a Cox Proportional-Hazards Model using the
<code>catalytic</code> package, the <code>cat_cox</code> function is
employed. This function facilitates the setup by preparing synthetic
data tailored for modeling purposes.</p>
<p>Here’s a breakdown of the parameters used:</p>
<ul>
<li><p><code>formula</code>: This parameter specifies the model formula
used in the Cox model. It defines the relationship between the response
variable and the predictors. Alternatively, besides using in format
<code>survival:Surv(TIME, STATUS) ~ COVARIATES</code>, user can also use
<code>~ COVARIATES</code> without specifying the response name, since
the response name is defined in the initialization step.</p></li>
<li><p><code>cat_init</code>: This parameter is essential and represents
the initialization object (<code>cat_init</code>) created by using <a href="#Initialization"><code>cat_cox_initialization</code></a>. It
contains both observed and synthetic data, plus other relevant
information, necessary for model fitting.</p></li>
<li><p><code>tau</code>: This parameter determines the down-weight
assigned to synthetic data relative to observed data. It influences the
influence of synthetic data in the model fitting process. If not
specified (<code>NULL</code>), it defaults to a one forth of the number
of predictors.</p></li>
<li><p><code>method</code>: The method for fitting the Cox model, either
“CRE” (Catalytic-regularized Estimator) or “WME” (weighted Mixture
Estimator). Default is “CRE”.</p></li>
<li><p><code>init_coefficients</code>: Initial coefficient values before
iteration. Defaults to zero if not provided (if using
<code>CRE</code>).</p></li>
<li><p><code>tol</code>: Convergence tolerance for iterative methods.
Default is <code>1e-5</code> (if using <code>CRE</code>).</p></li>
<li><p><code>max_iter</code>: Maximum number of iterations allowed for
convergence. Default is <code>25</code> (if using
<code>CRE</code>).</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>cat_cox_model <span class="ot">&lt;-</span> <span class="fu">cat_cox</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> ., <span class="co"># Same as `~ .`</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">cat_init =</span> cat_init,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">tau =</span> <span class="dv">10</span>, <span class="co"># Default: number of predictors</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;WME&quot;</span>, <span class="co"># Default: CRE</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">init_coefficients =</span> <span class="cn">NULL</span>, <span class="co"># Default: all zeros</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">tol =</span> <span class="fl">0.01</span>, <span class="co"># Default: 1e-5</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">max_iter =</span> <span class="dv">5</span> <span class="co"># Default: 25</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>cat_cox_model</span></code></pre></div>
<p>Here shows how users can simplify the input for <code>cat_cox</code>.
User do not have to specify <code>tau</code> and so on, as
<code>tau</code> and other parameters has their own default value ,
which mentioned above.</p>
<p>Let’s check the prediction score.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="st">&quot;Catalytic `cat_cox` - Predition Score:&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="at">X =</span> test_x,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="at">time =</span> test_time,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">status =</span> test_status,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="at">coefs =</span> <span class="fu">coef</span>(cat_cox_model),</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="at">entry_points =</span> test_entry_points</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  ) <span class="sc">-</span> MPLE_0</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Both <code>cat_cox_model</code> and <code>cat_cox_model</code>
objects are outputs from the <code>cat_cox</code> function, providing a
list of attributes for further analysis or user inspection.</p>
<p>Here’s a breakdown of all attributes except the input parameters:</p>
<ul>
<li><p><code>function_name</code>: The name of this function, which is
<code>cat_cox.</code></p></li>
<li><p><code>coefficients</code>: The coefficients of the fitted Cox
model.</p></li>
<li><p><code>model</code>: The fitted survival model (only for “WME”
method).</p></li>
<li><p><code>iter</code>: The number of iterations performed (only for
“CRE” method).</p></li>
<li><p><code>iteration_log</code>: The collected coefficients for each
iteration (only for “CRE” method).</p></li>
</ul>
<p>For more details, please check <code>?cat_cox</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">names</span>(cat_cox_model)</span></code></pre></div>
<p>User can extract items mentioned above from <code>cat_cox</code>
object.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># The formula used for modeling</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>cat_cox_model<span class="sc">$</span>formula</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># The fitted model object obtained from `survival::coxph` with `tau`</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>cat_cox_model<span class="sc">$</span>coefficients</span></code></pre></div>
</div>
<div id="cat_cox_tune" class="section level2">
<h2>Step 2.2: Choose Method(s) - Estimation with Selective tau</h2>
<p>The <code>cat_cox_tune</code> function fits a with a catalytic prior
on the regression coefficients and provides options for optimizing model
performance over a range of tau values(<code>tau_seq</code>).</p>
<p>These methods empower users to fit and optimize models with catalytic
priors, leveraging both observed and synthetic data to enhance model
performance and robustness in various statistical analyses.</p>
<div id="CrossValidation" class="section level3">
<h3>Cross-validation (risk_estimate_method = “cross_validation”)</h3>
<p>This method computes the partial likelihood across a specified range
of tau values (<code>tau_seq</code>). It iterates through each tau
value, evaluating its performance based on cross-validation folds
(<code>cross_validation_fold_num</code>) to select the optimal tau that
minimizes the discrepancy error.</p>
<p>Here’s a breakdown of the parameters used:</p>
<ul>
<li><p><code>formula</code>, <code>cat_init</code> and
<code>method</code> are same as <a href="#PointEstimate">above</a>.</p></li>
<li><p><code>tau_seq</code>: Vector of positive numeric values for
down-weighting synthetic data. Defaults to a sequence around the number
of predictors.</p></li>
<li><p><code>cross_validation_fold_num</code>: Number of folds for
cross-validation. Defaults to 5.</p></li>
<li><p><code>...</code> (ellipsis): Additional arguments passed to the
<code>cat_cox</code> function for model fitting.</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>cat_cox_tune_model <span class="ot">&lt;-</span> <span class="fu">cat_cox_tune</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> ., <span class="co"># Same as `~ .`</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">cat_init =</span> cat_init,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;CRE&quot;</span>, <span class="co"># Default: &quot;CRE&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">tau_seq =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.5</span>), <span class="co"># Default is a numeric sequence around the number of predictors</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">cross_validation_fold_num =</span> <span class="dv">3</span>, <span class="co"># Default: 5</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">tol =</span> <span class="dv">1</span> <span class="co"># Additional arguments passed to the `cat_cox` function</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>cat_cox_tune_model</span></code></pre></div>
<p>User can plot the tau_seq (x) against discrepancy error (y) using the
<code>plot()</code> function. This plot will show the lowest discrepancy
error at the optimal tau value.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(cat_cox_tune_model, <span class="at">text_pos =</span> <span class="dv">2</span>, <span class="at">legend_pos =</span> <span class="st">&quot;bottomright&quot;</span>)</span></code></pre></div>
<p>Here shows how users can simplify the input for
<code>cat_cox_tune</code>. User do not have to specify
<code>tau_seq</code> or some other augments, as most of the augments has
default values, which mentioned above.</p>
<p>Let’s check the prediction score.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="st">&quot;Catalytic `cat_cox_tune` - Predition Score:&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="at">X =</span> test_x,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">time =</span> test_time,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="at">status =</span> test_status,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">coefs =</span> <span class="fu">coef</span>(cat_cox_tune_model),</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">entry_points =</span> test_entry_points</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  ) <span class="sc">-</span> MPLE_0</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>)</span></code></pre></div>
<p><code>cat_cox_tune_model</code> and <code>cat_cox_tune_model</code>
objects are outputs from the <code>cat_cox_tune</code> function,
providing a list of attributes for further analysis or user
inspection.</p>
<p>Here’s a breakdown of all attributes except the input parameters:</p>
<ul>
<li><p><code>function_name</code>: The name of the function
(<code>cat_cox_tune</code>).</p></li>
<li><p><code>likelihood_list</code>: The collected likelihood values for
each tau.</p></li>
<li><p><code>tau</code>: Selected optimal tau value from
<code>tau_seq</code> that maximizes likelihood score.</p></li>
<li><p><code>model</code>: The fitted COX model object obtained with the
selected optimal tau (<code>tau</code>).</p></li>
<li><p><code>coefficients</code>: The estimated coefficients from the
fitted COX model (<code>model</code>).</p></li>
</ul>
<p>For more details, please check <code>?cat_cox_tune</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">names</span>(cat_cox_tune_model)</span></code></pre></div>
<p>User can extract items mentioned above from <code>cat_cox_tune</code>
object.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># The estimated coefficients from the fitted model</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>cat_cox_tune_model<span class="sc">$</span>coefficients</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Selected optimal tau value from `tau_seq` that maximize the likelihood</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>cat_cox_tune_model<span class="sc">$</span>tau</span></code></pre></div>
</div>
</div>
<div id="cat_cox_bayes" class="section level2">
<h2>Step 2.3: Bayesian Posterior Sampling with Fixed tau</h2>
<p>Now, we will explore advanced Bayesian modeling techniques tailored
for COX using the <code>catalytic</code> package. Bayesian inference
offers a powerful framework to estimate model parameters and quantify
uncertainty by integrating prior knowledge with observed data.</p>
<p>Below functions enable Bayesian inference for COX Regression Model
with catalytic priors. This function utilizes Markov chain Monte Carlo
(MCMC) methods, implemented using the <code>rstan</code> package, to
sample from the posterior distribution of model parameters. Users can
specify various options such as the number of MCMC chains
(<code>chains</code>), iterations (<code>iter</code>) and warmup steps
(<code>warmup</code>). User could also apply other attributes to
<code>rstan::sampling</code>, like <code>refresh</code> and
<code>control</code>.</p>
<p>In this section, we explore Bayesian approaches using the
<code>cat_cox_bayes</code> function from the <code>catalytic</code>
package. This function can fit a Bayesian Generalized COX Model (GLM)
using a fixed tau value. The MCMC sampling process will generate
posterior distributions for the coefficients based on the specified
tau.</p>
<p>Here’s a breakdown of the parameters used:</p>
<ul>
<li><p><code>formula</code>, <code>cat_init</code> and <code>tau</code>
are same as <a href="#cat_glm">above</a>.</p></li>
<li><p><code>chains</code>: Number of Markov chains to run during MCMC
sampling in <code>rstan::sampling</code>. Defaults to 4.</p></li>
<li><p><code>iter</code>: Total number of iterations per chain in the
MCMC sampling process in <code>rstan::sampling</code>. Defaults to
2000.</p></li>
<li><p><code>warmup</code>: Number of warmup iterations in the MCMC
sampling process in <code>rstan::sampling</code>, discarded as burn-in.
Defaults to 1000.</p></li>
<li><p><code>hazard_beta</code>: Shape parameter for the Gamma
distribution in the hazard model. Defaults to 2.</p></li>
<li><p><code>...</code> (ellipsis): Denotes additional arguments that
can be passed directly to the underlying <code>rstan::sampling</code>
function used within <code>cat_cox_bayes</code> to fit the Bayesian
model. These arguments allow for customization of the Bayesian fitting
process, such as <code>control</code>, <code>refresh</code>, or other
model-specific settings.</p></li>
</ul>
<p>For more details, please refer to <code>?cat_cox_bayes</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>cat_cox_bayes_model <span class="ot">&lt;-</span> <span class="fu">cat_cox_bayes</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> ., <span class="co"># Same as `~ .</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">cat_init =</span> cat_init,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">tau =</span> <span class="dv">1</span>, <span class="co"># Default: NULL</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>, <span class="co"># Default: 4</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">100</span>, <span class="co"># Default: 2000</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">50</span>, <span class="co"># Default: 1000</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="at">hazard_beta =</span> <span class="dv">2</span> <span class="co"># Default: 2</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>cat_cox_bayes_model</span></code></pre></div>
<p>Here shows how users can simplify the input for
<code>cat_cox_bayes</code>. User do not have to specify <code>tau</code>
and other attributes, as <code>tau</code> and other attributes have
default value, which mentioned above. Here we assign lower value to
<code>chains</code>, <code>iter</code> and <code>warmup</code> for
quicker processing time.</p>
<p>User can also get the traceplot of the <code>rstan</code> model by
using <code>traceplot()</code> directly into the output from
<code>cat_cox_bayes</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">traceplot</span>(cat_cox_bayes_model)</span></code></pre></div>
<p>Plus, user can use this <code>catlaytic::traceplot</code> just like
the <code>rstan::traceplot</code>, user can add parameters used in
<code>rstan::traceplot</code>, like <code>include</code> and
<code>inc_warmup</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">traceplot</span>(cat_cox_bayes_model, <span class="at">inc_warmup =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Let’s check the prediction score.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="st">&quot;Catalytic `cat_cox_bayes` - Predition Score:&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">X =</span> test_x,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="at">time =</span> test_time,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="at">status =</span> test_status,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="at">coefs =</span> <span class="fu">coef</span>(cat_cox_bayes_model),</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    <span class="at">entry_points =</span> test_entry_points</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  ) <span class="sc">-</span> MPLE_0</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Both <code>cat_cox_bayes_model</code> and
<code>cat_cox_bayes_model</code> objects are outputs from the
<code>cat_cox_bayes</code> function, providing a list of attributes for
further analysis or user inspection.</p>
<p>Here’s a breakdown of all attributes except the input parameters:</p>
<ul>
<li><p><code>function_name</code>: The name of the function
(<code>cat_cox_bayes</code>).</p></li>
<li><p><code>stan_data</code>: The data list used for
<code>rstan::sampling</code>.</p></li>
<li><p><code>stan_model</code>: The <code>rstan::stan_model</code>
object used for Bayesian modeling.</p></li>
<li><p><code>stan_sample_model</code>: The result object obtained from
<code>rstan::sampling</code>, encapsulating the MCMC sampling
results.</p></li>
<li><p><code>coefficients</code>: The mean estimated coefficients from
the Bayesian model, extracted from
<code>rstan::summary(stan_sample_model)$summary</code>.</p></li>
<li><p><code>increment_cumulative_baseline_hazard</code>: The mean of
the increment in cumulative baseline hazard extracted from
<code>rstan::summary(stan_sample_model)$summary</code>.</p></li>
</ul>
<p>For more details, please refer to <code>?cat_cox_bayes</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">names</span>(cat_cox_bayes_model)</span></code></pre></div>
<p>User can extract items mentioned above from
<code>cat_cox_bayes</code> object.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># The number of Markov chains used during MCMC sampling in `rstan`.</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>cat_cox_bayes_model<span class="sc">$</span>chain</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># The mean estimated coefficients from the Bayesian model</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>cat_cox_bayes_model<span class="sc">$</span>coefficients</span></code></pre></div>
</div>
<div id="cat_cox_bayes_joint" class="section level2">
<h2>2.4 Bayesian Posterior Sampling with Adaptive Tau</h2>
<p>In this section, we delve into Bayesian methodologies employing the
<code>cat_cox_bayes_joint</code> function within the
<code>catalytic</code> package. Unlike its non-adaptive counterpart
(<code>cat_cox_bayes</code>), this method employs a joint tau prior
approach where tau is treated as a parameter within the MCMC sampling
process, improving the robustness and accuracy of parameter estimation
in Bayesian gaussian modeling.</p>
<p>In this section, we explore Bayesian approaches using the
<code>cat_cox_bayes_joint</code> function from the
<code>catalytic</code> package. These functions are similar to their
non-adaptive (non-joint) version (<code>cat_cox_bayes</code>), but
corporate <code>tau</code> into the MCMC sampling process.</p>
<p>Here’s a breakdown of the parameters used:</p>
<ul>
<li><p><code>formula</code> and <code>cat_init</code> are same as <a href="#cat_cox">above</a>.</p></li>
<li><p><code>chains</code>, <code>iter</code>, <code>warmup</code> and
<code>hazard_beta</code> are same in section <a href="#cat_cox_bayes">Bayesian Posterior Sampling with Fixed
Tau</a>.</p></li>
<li><p><code>tau_alpha</code>: Alpha parameter controlling degrees of
freedom for distribution in the joint tau approach. Default is
2.</p></li>
<li><p><code>tau_gamma</code>: Gamma parameter in the joint tau
approach. Default is 1.</p></li>
<li><p><code>...</code>(ellipsis): Denotes additional arguments that can
be passed directly to the underlying <code>rstan::sampling</code>
function used within <code>cat_cox_bayes_joint</code> to fit the
Bayesian model. These arguments allow for customization of the Bayesian
fitting process, such as <code>control</code>, <code>refresh</code>, or
other model-specific settings.</p></li>
</ul>
<p>For more details, please refer to
<code>?cat_cox_bayes_joint</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>cat_cox_bayes_joint_model <span class="ot">&lt;-</span> <span class="fu">cat_cox_bayes_joint</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="at">formula =</span> survival<span class="sc">::</span><span class="fu">Surv</span>(time, status) <span class="sc">~</span> ., <span class="co"># Same as `~ .</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="at">cat_init =</span> cat_init,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">1</span>, <span class="co"># Default: 4</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">100</span>, <span class="co"># Default: 2000</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">50</span>, <span class="co"># Default: 1000</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="at">tau_alpha =</span> <span class="dv">2</span>, <span class="co"># Default: 2</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="at">tau_gamma =</span> <span class="dv">1</span>, <span class="co"># Default: 1</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="at">hazard_beta =</span> <span class="dv">2</span> <span class="co"># Default: 2</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>cat_cox_bayes_joint_model</span></code></pre></div>
<p>Here shows how users can simplify the input for
<code>cat_cox_bayes_joint</code>. User do not have to specify
<code>chains</code> and other attributes, as they have default values,
which mentioned above. Here we assign lower value to
<code>chains</code>, <code>iter</code> and <code>warmup</code> for
quicker processing time.</p>
<p>User can also get the traceplot of the <code>rstan</code> model by
using <code>traceplot()</code> directly into the output from
<code>cat_cox_bayes_joint</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">traceplot</span>(cat_cox_bayes_joint_model)</span></code></pre></div>
<p>Like the <a href="#cat_cox_bayes"><code>traceplot</code> shown in the
<code>cat_cox_bayes</code> function</a> , user can add parameters used
in <code>rstan::traceplot</code>, like <code>include</code> and
<code>inc_warmup</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">traceplot</span>(cat_cox_bayes_joint_model, <span class="at">inc_warmup =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Let’s check the prediction score.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="st">&quot;Catalytic `cat_cox_bayes_joint` - Predition Score:&quot;</span>,</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">get_cox_partial_likelihood</span>(</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    <span class="at">X =</span> test_x,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="at">time =</span> test_time,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    <span class="at">status =</span> test_status,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    <span class="at">coefs =</span> <span class="fu">coef</span>(cat_cox_bayes_joint_model),</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    <span class="at">entry_point =</span> test_entry_points</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  ) <span class="sc">-</span> MPLE_0</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Both <code>cat_cox_bayes_joint_model</code> and
<code>cat_cox_bayes_joint_model</code> objects are outputs from the
<code>cat_cox_bayes_joint</code> function, providing a list of
attributes for further analysis or user inspection.</p>
<p>Here’s a breakdown of all attributes except the input parameters:</p>
<ul>
<li><p><code>function_name</code>: The name of the function
(<code>cat_cox_bayes_joint</code>).</p></li>
<li><p><code>tau</code>: The estimated tau parameter from the MCMC
sampling <code>rstan::sampling</code>, depending on the model
configuration.</p></li>
<li><p><code>stan_data</code>, <code>stan_model</code>,
<code>stan_sample_model</code>, <code>coefficients</code> and
<code>increment_cumulative_baseline_hazard</code> are same in section <a href="#cat_glm_bayes">Bayesian Posterior Sampling with Fixed
Tau</a>.</p></li>
</ul>
<p>For more details, please refer to
<code>?cat_cox_bayes_joint</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">names</span>(cat_cox_bayes_joint_model)</span></code></pre></div>
<p>User can extract items mentioned above from
<code>cat_cox_bayes_joint</code> object.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># The estimated tau parameter from the MCMC sampling `rstan::sampling`,</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>cat_cox_bayes_joint_model<span class="sc">$</span>tau</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># The mean estimated coefficients from the Bayesian model</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>cat_cox_bayes_joint_model<span class="sc">$</span>coefficients</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-catalytic_cox" class="csl-entry">
Li, Weihao, and Dongming Huang. 2023. <span>“Yesian Inference on Cox
Regression Models Using Catalytic Prior Distributions.”</span>
<em>ArXiv</em>. <a href="https://arxiv.org/abs/2312.01411">https://arxiv.org/abs/2312.01411</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
